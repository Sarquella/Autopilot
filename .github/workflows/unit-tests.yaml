name: âœ… Unit Tests

on:
  pull_request:
    branches: ["main"]

jobs:
  build:
    name: Unit Tests
    runs-on: macos-13

    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: ðŸ”¨ Xcode version
        run: |
          xcodebuild -version
      - name: ðŸ“¦ SPM Cache
        uses: actions/cache@v3
        with:
          path: .spm-cache
          key: ${{ runner.os }}-spm-${{ hashFiles('**/Package.resolved') }}
          restore-keys: |
            ${{ runner.os }}-spm-
      - name: âœ… Unit Tests
        run: |
          xcodebuild test \
          -scheme Autopilot \
          -clonedSourcePackagesDirPath '.spm-cache' \
          -disableAutomaticPackageResolution \
          -onlyUsePackageVersionsFromResolvedFile \
          -skipPackageUpdates \
          -destination 'platform=macOS,name=Any Mac'
